---
import merge from 'lodash.merge';
import Container from './Container.astro';
import type { ContainerProps, SidebarContainerProps } from '~/types/container.types';
import { cn } from '~/utils/styles';

type Props = SidebarContainerProps;

const {
  gap = 'gap-6',
  responsive = false,
  breakpoint = 'md:',
  sidebar,
  mainContent,
  ...containerProps
} = Astro.props;

const layoutClass = cn(
  responsive ? `grid-cols-1 ${breakpoint}grid-cols-[1fr_3fr]` : 'grid-cols-[1fr_3fr]',
  gap
);

const sidebarClass = cn(
  sidebar?.background?.class,
  sidebar?.spacing?.padding,
  sidebar?.spacing?.margin,
  sidebar?.border?.width,
  sidebar?.border?.color,
  sidebar?.border?.radius,
  sidebar?.class
);

const mainContentClass = cn(
  mainContent?.background?.class,
  mainContent?.spacing?.padding,
  mainContent?.spacing?.margin,
  mainContent?.border?.width,
  mainContent?.border?.color,
  mainContent?.border?.radius,
  mainContent?.class
);

const defaultContainer = {
  htmlTag: 'div',
  content: { air: 'none', widthType: 'full' },
  layout: { type: 'grid', class: layoutClass },
  printDebug: true,
} as ContainerProps;

const mergedContainerProps = merge({}, defaultContainer, containerProps);
---

<Container {...mergedContainerProps}>
  <div class={sidebarClass}>
    <slot name="sidebar" />
  </div>
  <div class={mainContentClass}>
    <slot name="main" />
  </div>
</Container>
